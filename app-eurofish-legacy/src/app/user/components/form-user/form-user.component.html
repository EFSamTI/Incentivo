<app-loading-scream [isLoading]="isLoading"></app-loading-scream>
<p-dialog
  header="{{ user ? 'Editar Usuario' : 'Crear Usuario' }}"
  [(visible)]="displayForm"
  [modal]="true"
  [style]="{ width: '450px' }"
  (onHide)="close()"
  class="p-fluid"
>
  <ng-template pTemplate="content">
    <form [formGroup]="userForm">
      <div class="field">
        <label for="name">Nombre de completo</label>
        <input
          type="text"
          pInputText
          formControlName="name"
          class="w-full"
          name="name"
          placeholder="Ingrese el nombre del rol"
        />
        <small
          *ngIf="name.invalid && (name.dirty || name.touched)"
          class="block p-error"
        >
          <div *ngIf="name.errors?.['required']">
            El nombre de rol es requerido.
          </div>
        </small>
      </div>
      <div class="field">
        <label for="roles" style="margin-bottom: 10px">Roles</label>
        <p-multiSelect
          formControlName="roles"
          [options]="listRoles"
          optionLabel="roleName"
          optionValue="roleName"
          placeholder="Seleccione los roles"
          [style]="{ width: '100%' }"
        ></p-multiSelect>
        <small
          *ngIf="roles.invalid && (roles.dirty || roles.touched)"
          class="block p-error"
        >
          <div *ngIf="roles.errors?.['required']">El rol es requerido.</div>
        </small>
      </div>
      <div class="field">
        <label for="username">Nombre de usuario</label>
        <input
          type="text"
          pInputText
          formControlName="username"
          class="w-full"
          name="username"
          placeholder="Ingrese el nombre de usuario"
        />
        <small
          *ngIf="username.invalid && (username.dirty || username.touched)"
          class="block p-error"
        >
          <div *ngIf="username.errors?.['required']">
            El nombre de usuario es requerido.
          </div>
        </small>
      </div>

      <div class="field">
        <label for="password">Contraseña</label>
        <input
          type="password"
          pInputText
          formControlName="password"
          class="w-full"
          name="password"
          placeholder="Ingrese la contraseña"
        />
        <small
          *ngIf="password.invalid && (password.dirty || password.touched)"
          class="block p-error"
        >
          <div *ngIf="password.errors?.['required']">
            La contraseña es requerida.
          </div>
        </small>
      </div>

      <div class="field" *ngIf="!user">
        <label for="foto">Foto</label>
        <p-fileUpload
          name="demo[]"
          (onSelect)="onFileSelect($event)"
          [multiple]="false"
          accept="image/*"
          [maxFileSize]="614400"
        >
        </p-fileUpload>
      </div>
    </form>
  </ng-template>
  <ng-template pTemplate="footer">
    <button
      pButton
      type="button"
      label="Cancelar"
      class="p-button-text"
      (click)="close()"
    ></button>
    <button
      pButton
      type="button"
      label="Guardar"
      class="p-button-success"
      [disabled]="userForm.invalid"
      (click)="submit()"
    ></button>
  </ng-template>
</p-dialog>
<button
  pButton
  pRipple
  (click)="displayForm = true"
  class="p-button-success mr-2"
  icon="pi pi-plus"
  label="Nuevo"
  type="button"
></button>
